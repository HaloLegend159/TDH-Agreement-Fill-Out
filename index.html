<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TDH Agreement – Web Form → PDF (No-Overlap Layout)</title>
<meta name="color-scheme" content="dark light" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f172a;--panel:#111827;--ink:#e5e7eb;--muted:#94a3b8;--accent:#22d3ee;--border:#1f2937;--radius:14px;--gap:14px
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.6 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  a{color:var(--accent);text-decoration:none}
  .wrap{max-width:1200px;margin:20px auto;padding:0 16px 96px}
  .toolbar{position:sticky;top:0;z-index:5;backdrop-filter:blur(8px);background:color-mix(in oklab, var(--bg) 75%, transparent);border-bottom:1px solid var(--border)}
  .toolbar-inner{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:10px 0}
  .title{display:flex;gap:10px;align-items:center;font-weight:700}
  .title .dot{width:10px;height:10px;border-radius:999px;background:var(--accent);box-shadow:0 0 18px var(--accent)}
  .btn{appearance:none;border:none;background:#0ea5e9;color:white;font-weight:600;padding:10px 14px;border-radius:10px;cursor:pointer;transition:transform .05s ease, opacity .2s ease;box-shadow:0 4px 14px rgba(0,0,0,.2)}
  .btn.secondary{background:#334155}
  .btn.ghost{background:transparent;color:var(--ink);border:1px solid var(--border)}
  .btn:active{transform:translateY(1px)}
  .panel{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-top:16px}
  .panel h2{margin:0 0 10px;font-size:16px;letter-spacing:.2px}
  .row{display:grid;gap:var(--gap)}
  .row.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .row.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width: 900px){.row.cols-2,.row.cols-3{grid-template-columns:1fr}}
  .field{display:grid;gap:6px}
  label{font-weight:600;color:var(--muted);font-size:12px;letter-spacing:.3px}
  input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#0b1220;color:var(--ink);outline:none}
  textarea{min-height:84px;resize:vertical}
  .chipset{display:flex;flex-wrap:wrap;gap:8px}
  .chip{display:inline-flex;align-items:center;gap:8px;background:#0b1220;border:1px solid var(--border);padding:8px 10px;border-radius:999px}
  .note{color:var(--muted);font-size:12px}
  .hr{height:1px;background:var(--border);margin:20px 0}

  /* === PRINTABLE (bulletproof, no-overlap) === */
  /* We render into an 8.5x11in page at CSS pixels ~ 816x1056. We use a simple two-column grid (fixed label column) to avoid collisions. */
  #printRoot{position:fixed;inset:0;pointer-events:none;opacity:0}
  .page{width:816px;min-height:1056px;background:#fff;color:#0b1220;padding:28px 32px;border:1px solid #e5e7eb;border-radius:8px}
  .h1{font-size:22px;font-weight:700;margin:0 0 4px}
  .sub{color:#475569;margin:0 0 16px}
  .sec{margin-top:14px}
  .sec-title{font-size:14px;font-weight:700;margin:0 0 6px;border-bottom:1px solid #e5e7eb;padding-bottom:4px}
  .kv{display:grid;grid-template-columns:220px 1fr;gap:4px 10px;align-items:start}
  .kv + .kv{margin-top:6px}
  .k{font-size:11px;color:#64748b}
  .v{font-size:13px;font-weight:600;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;line-height:1.5}
  .pillrow{display:flex;flex-wrap:wrap;gap:6px}
  .pill{display:inline-block;background:#eef2ff;border:1px solid #c7d2fe;color:#1e3a8a;border-radius:999px;padding:2px 8px;font-size:11px}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:6px 10px}
  .avoid-break{page-break-inside:avoid}
</style>
</head>
<body>
  <div class="wrap">
    <div class="toolbar">
      <div class="toolbar-inner">
        <div class="title"><span class="dot"></span><span>TDH Agreement – Form → PDF</span></div>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn ghost" id="btnExample" title="Fill with example data">Load Example</button>
          <button class="btn secondary" id="btnClear" title="Clear all fields">Clear</button>
          <button class="btn" id="btnDownload" title="Generate a polished PDF">Download PDF</button>
        </div>
      </div>
    </div>

    <p class="note">Uses a rock‑solid two‑column layout in the PDF to prevent clipping or overlap. Long text automatically wraps.</p>

    <!-- GENERAL INFO -->
    <section class="panel">
      <h2>General Info</h2>
      <div class="row cols-3">
        <div class="field"><label for="name">Name</label><input id="name" placeholder="Full name"/></div>
        <div class="field"><label for="primaryContactName">Primary Contact Name</label><input id="primaryContactName"/></div>
        <div class="field"><label for="primaryContactPhone">Primary Contact Phone</label><input id="primaryContactPhone" placeholder="(555) 555‑5555"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="insuranceCompany">Insurance Company</label><input id="insuranceCompany"/></div>
        <div class="field"><label for="claimNumber">Claim Number</label><input id="claimNumber"/></div>
        <div class="field"><label for="phone">Phone</label><input id="phone" placeholder="(555) 555‑5555"/></div>
      </div>
      <div class="row cols-2" style="margin-top:var(--gap)">
        <div class="field"><label for="address">Address</label><input id="address" placeholder="Street address"/></div>
        <div class="field"><label for="cityStateZip">City, State, Zip</label><input id="cityStateZip" placeholder="City, ST 00000"/></div>
      </div>
    </section>

    <!-- ROOFING INFO -->
    <section class="panel">
      <h2>Roofing Info</h2>
      <div class="row cols-3">
        <div class="field">
          <label>Roofing locations</label>
          <div class="chipset" id="roofLocations">
            <label class="chip"><input type="checkbox" value="House"> House</label>
            <label class="chip"><input type="checkbox" value="Garage"> Garage</label>
            <label class="chip"><input type="checkbox" value="Shed"> Shed</label>
            <label class="chip"><input type="checkbox" value="Flat"> Flat</label>
          </div>
        </div>
        <div class="field"><label for="tearOffLayers">Tear off layers</label><input id="tearOffLayers" placeholder="# of layers" /></div>
        <div class="field">
          <label>Underlayment</label>
          <div class="chipset" id="underlayment">
            <label class="chip"><input type="radio" name="underlayment" value="15lb"> 15lb</label>
            <label class="chip"><input type="radio" name="underlayment" value="30lb"> 30lb</label>
            <label class="chip"><input type="radio" name="underlayment" value="Synthetic"> Synthetic</label>
          </div>
        </div>
      </div>

      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="shinglesBrand">Shingles Brand</label><input id="shinglesBrand"/></div>
        <div class="field"><label for="style">Style</label><input id="style" placeholder="Architectural, 3‑tab, etc."/></div>
        <div class="field"><label for="color">Color</label><input id="color"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="sqs">SQs</label><input id="sqs"/></div>
        <div class="field"><label for="iceWater">Ice & Water Barrier</label><input id="iceWater"/></div>
        <div class="field"><label for="dripEdge">Drip Edge</label><input id="dripEdge"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="gutterApron">Gutter Apron</label><input id="gutterApron"/></div>
        <div class="field"><label for="sideWallFlashing">Side Wall Flashing</label><input id="sideWallFlashing" placeholder="Metal or Plastic"/></div>
        <div class="field"><label for="vents">Vents</label><input id="vents" placeholder="Type / Count"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="valleys">Valleys</label><input id="valleys" placeholder="Open or Closed"/></div>
        <div class="field"><label for="pipeJacks">Pipe Jacks</label><input id="pipeJacks" placeholder="QTY / Type"/></div>
        <div class="field"><label for="ridge">Ridge Cap / Ridge Vent</label><input id="ridge" placeholder="Cap / Vent"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="roofPitch">Roof Pitch</label><input id="roofPitch"/></div>
        <div class="field"><label for="stories">Stories</label><input id="stories"/></div>
        <div class="field"><label for="roofSize">Roof Size</label><input id="roofSize" placeholder="Approx. sq ft"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field">
          <label>Roof Type</label>
          <div class="chipset" id="roofType">
            <label class="chip"><input type="radio" name="roofType" value="Hip"> Hip</label>
            <label class="chip"><input type="radio" name="roofType" value="Gable"> Gable</label>
            <label class="chip"><input type="radio" name="roofType" value="Both"> Both</label>
          </div>
        </div>
      </div>
    </section>

    <!-- GUTTERS -->
    <section class="panel">
      <h2>Gutters & Downspouts</h2>
      <div class="row cols-3">
        <div class="field"><label for="gutters">Gutters</label><input id="gutters" placeholder="5\" / 6\""/></div>
        <div class="field"><label for="downspouts">Downspouts</label><input id="downspouts" placeholder="2x3 / 3x4"/></div>
        <div class="field"><label for="gutterColor">Gutter Color</label><input id="gutterColor"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="downspoutColor">Downspout Color</label><input id="downspoutColor"/></div>
        <div class="field"><label for="gutterGuards">Gutter Guards</label><input id="gutterGuards" placeholder="Plastic / RX / Leaf Free"/></div>
        <div class="field"><label for="magRoll">Mag Roll Sweeper</label><input id="magRoll" placeholder="Yes / No"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="debris">Clean & Haul Debris</label><input id="debris" placeholder="Yes / No"/></div>
      </div>
    </section>

    <!-- SIDING -->
    <section class="panel">
      <h2>Siding</h2>
      <div class="row cols-3">
        <div class="field"><label for="sidingBrand">Brand</label><input id="sidingBrand"/></div>
        <div class="field"><label for="sidingStyle">Style</label><input id="sidingStyle"/></div>
        <div class="field"><label for="sidingSqs">SQs</label><input id="sidingSqs"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="sidingColor">Color</label><input id="sidingColor"/></div>
        <div class="field"><label for="elevations">Elevations</label><input id="elevations" placeholder="Front / Rear / Left / Right"/></div>
        <div class="field"><label for="trim">Trim</label><input id="trim"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="fascia">Fascia</label><input id="fascia" placeholder="Smooth / PVC"/></div>
        <div class="field"><label for="soffit">Soffit</label><input id="soffit" placeholder="Solid / Vented"/></div>
        <div class="field"><label for="windowWraps">Window Wraps</label><input id="windowWraps" placeholder="Smooth / PVC"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="blocks">Blocks</label><input id="blocks" placeholder="Light / Split"/></div>
        <div class="field"><label for="sidingNotes">Notes</label><input id="sidingNotes" placeholder="Any additional siding info"/></div>
        <div class="field"><label for="partialFull">Partial or Full</label><input id="partialFull"/></div>
      </div>
    </section>

    <!-- MORE / PAYMENT -->
    <section class="panel">
      <h2>Materials / Interior / Payments</h2>
      <div class="row cols-3">
        <div class="field"><label for="materialDrop">Material drop off</label><input id="materialDrop" placeholder="Address / Notes"/></div>
        <div class="field"><label for="redeck">Redeck</label><input id="redeck" placeholder="Yes / No / Areas"/></div>
        <div class="field"><label for="interior">Interior damage</label><input id="interior" placeholder="Rooms / Notes"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="agreedAmount">Agreed Amount ($)</label><input id="agreedAmount" type="number" inputmode="decimal" placeholder="0.00"/></div>
        <div class="field"><label for="firstPayment">First Payment ($)</label><input id="firstPayment" type="number" inputmode="decimal" placeholder="0.00"/></div>
        <div class="field"><label for="finalPayment">Final Payment ($)</label><input id="finalPayment" type="number" inputmode="decimal" placeholder="0.00"/></div>
      </div>
      <div class="row cols-3" style="margin-top:var(--gap)">
        <div class="field"><label for="custDate">Agreed by Customer (date)</label><input id="custDate" type="date"/></div>
        <div class="field"><label for="repDate">Agreed by TDH Rep (date)</label><input id="repDate" type="date"/></div>
        <div class="field"><label for="repName">TDH Representative</label><input id="repName" placeholder="Name"/></div>
      </div>
    </section>

    <div class="hr"></div>

    <div id="printRoot"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-YcsIPYwjl4QXG8Hk9wDqI8t0w+M1q0sYKJr2Q9m3aRuA7+R7oKrLAY9z1xj3c3B3QX0cQn1y0n4VZ0CPwAJ6pg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => [...root.querySelectorAll(sel)];

    function getCheckedChips(container){return $$("input[type='checkbox']:checked", container).map(i=>i.value)}
    function getCheckedRadio(container){const r=$("input[type='radio']:checked",container);return r? r.value: ""}

    function collectData(){
      return {
        name: $('#name').value.trim(),
        primaryContactName: $('#primaryContactName').value.trim(),
        primaryContactPhone: $('#primaryContactPhone').value.trim(),
        insuranceCompany: $('#insuranceCompany').value.trim(),
        claimNumber: $('#claimNumber').value.trim(),
        phone: $('#phone').value.trim(),
        address: $('#address').value.trim(),
        cityStateZip: $('#cityStateZip').value.trim(),
        roofLocations: getCheckedChips($('#roofLocations')),
        tearOffLayers: $('#tearOffLayers').value.trim(),
        underlayment: getCheckedRadio($('#underlayment')),
        shinglesBrand: $('#shinglesBrand').value.trim(),
        style: $('#style').value.trim(),
        color: $('#color').value.trim(),
        sqs: $('#sqs').value.trim(),
        iceWater: $('#iceWater').value.trim(),
        dripEdge: $('#dripEdge').value.trim(),
        gutterApron: $('#gutterApron').value.trim(),
        sideWallFlashing: $('#sideWallFlashing').value.trim(),
        vents: $('#vents').value.trim(),
        valleys: $('#valleys').value.trim(),
        pipeJacks: $('#pipeJacks').value.trim(),
        ridge: $('#ridge').value.trim(),
        roofPitch: $('#roofPitch').value.trim(),
        stories: $('#stories').value.trim(),
        roofSize: $('#roofSize').value.trim(),
        roofType: getCheckedRadio($('#roofType')),
        gutters: $('#gutters').value.trim(),
        downspouts: $('#downspouts').value.trim(),
        gutterColor: $('#gutterColor').value.trim(),
        downspoutColor: $('#downspoutColor').value.trim(),
        gutterGuards: $('#gutterGuards').value.trim(),
        magRoll: $('#magRoll').value.trim(),
        debris: $('#debris').value.trim(),
        sidingBrand: $('#sidingBrand').value.trim(),
        sidingStyle: $('#sidingStyle').value.trim(),
        sidingSqs: $('#sidingSqs').value.trim(),
        sidingColor: $('#sidingColor').value.trim(),
        elevations: $('#elevations').value.trim(),
        trim: $('#trim').value.trim(),
        fascia: $('#fascia').value.trim(),
        soffit: $('#soffit').value.trim(),
        windowWraps: $('#windowWraps').value.trim(),
        blocks: $('#blocks').value.trim(),
        sidingNotes: $('#sidingNotes').value.trim(),
        partialFull: $('#partialFull').value.trim(),
        materialDrop: $('#materialDrop').value.trim(),
        redeck: $('#redeck').value.trim(),
        interior: $('#interior').value.trim(),
        agreedAmount: $('#agreedAmount').value,
        firstPayment: $('#firstPayment').value,
        finalPayment: $('#finalPayment').value,
        custDate: $('#custDate').value,
        repDate: $('#repDate').value,
        repName: $('#repName').value.trim()
      }
    }

    function clearForm(){
      $$('input, textarea, select').forEach(el=>{
        if(el.type==='checkbox' || el.type==='radio'){ el.checked = false; }
        else { el.value = ''; }
      });
    }

    function loadExample(){
      const ex = {
        name:'Jordan & Casey Mitchell', primaryContactName:'Casey Mitchell', primaryContactPhone:'(402) 555‑0199',
        insuranceCompany:'Prairie Mutual', claimNumber:'PM‑NE‑24‑11827', phone:'(402) 555‑0177',
        address:'2513 River Rd Dr', cityStateZip:'Waterloo, NE 68069', roofLocations:['House','Garage'],
        tearOffLayers:'1', underlayment:'Synthetic', shinglesBrand:'Malarkey Vista', style:'Architectural', color:'Weathered Wood', sqs:'28',
        iceWater:'Yes – eaves/valleys (per code)', dripEdge:'Yes – charcoal', gutterApron:'Yes – charcoal', sideWallFlashing:'Metal',
        vents:'4 box vents – black', valleys:'Open (metal)', pipeJacks:'3 – neoprene', ridge:'Ridge cap – matching', roofPitch:'6/12', stories:'2', roofSize:'~2,800 sq ft', roofType:'Gable',
        gutters:'5"', downspouts:'3x4', gutterColor:'Charcoal', downspoutColor:'Charcoal', gutterGuards:'Leaf Free', magRoll:'Yes', debris:'Yes',
        sidingBrand:'LP SmartSide', sidingStyle:'Lap 8"', sidingSqs:'19', sidingColor:'Charcoal', elevations:'Front, Rear, Left, Right', trim:'PVC', fascia:'Smooth', soffit:'Vented', windowWraps:'Smooth', blocks:'2 Light, 1 Split', sidingNotes:'Replace damaged starter strips on north elevation', partialFull:'Partial – storm faces only',
        materialDrop:'Driveway (left side) – 7am OK', redeck:'No', interior:'Master bath ceiling stain', agreedAmount:'18124.55', firstPayment:'5000.00', finalPayment:'13124.55',
        custDate:new Date().toISOString().slice(0,10), repDate:new Date().toISOString().slice(0,10), repName:'TDH Rep – J. Morales'
      };
      // Fill
      for(const [k,v] of Object.entries(ex)){
        const el = document.getElementById(k);
        if(el){ el.value = v }
      }
      // Set chips/radios
      $$('#roofLocations input[type="checkbox"]').forEach(cb=>{cb.checked = ex.roofLocations.includes(cb.value)});
      $$('#underlayment input[type="radio"]').forEach(r=>{r.checked = (r.value===ex.underlayment)});
      $$('#roofType input[type="radio"]').forEach(r=>{r.checked = (r.value===ex.roofType)});
    }

    function currency(n){if(n==null||n==='')return'';const v=Number(n);if(Number.isNaN(v))return n;return v.toLocaleString(undefined,{style:'currency',currency:'USD'})}

    function kv(parent,label,value){
      const wrap = document.createElement('div');
      wrap.className = 'kv';
      wrap.innerHTML = `<div class="k">${label}</div><div class="v">${value || '—'}</div>`;
      parent.appendChild(wrap);
    }

    function buildPrintable(d){
      const root = $('#printRoot');
      root.innerHTML = '';
      const page = document.createElement('div');
      page.className = 'page';

      const header = document.createElement('div');
      header.innerHTML = `<div class="h1">TDH Agreement</div><div class="sub">Generated ${new Date().toLocaleDateString()}</div>`;

      const sec = (title)=>{
        const s = document.createElement('section');
        s.className = 'sec avoid-break';
        s.innerHTML = `<div class="sec-title">${title}</div>`;
        return s;
      };

      // General
      const s1 = sec('General Information');
      kv(s1,'Name', d.name);
      kv(s1,'Primary Contact', d.primaryContactName);
      kv(s1,'Primary Phone', d.primaryContactPhone);
      kv(s1,'Insurance Company', d.insuranceCompany);
      kv(s1,'Claim Number', d.claimNumber);
      kv(s1,'Phone', d.phone);
      kv(s1,'Address', d.address);
      kv(s1,'City/State/Zip', d.cityStateZip);

      // Roofing
      const s2 = sec('Roofing');
      const locWrap = document.createElement('div'); locWrap.className='kv';
      const pillRow = `<div class="pillrow">${(d.roofLocations||[]).map(x=>`<span class='pill'>${x}</span>`).join('') || '—'}</div>`;
      locWrap.innerHTML = `<div class="k">Locations</div><div class="v">${pillRow}</div>`;
      s2.appendChild(locWrap);
      kv(s2,'Tear Off Layers', d.tearOffLayers);
      kv(s2,'Underlayment', d.underlayment);
      kv(s2,'Shingles Brand', d.shinglesBrand);
      kv(s2,'Style', d.style);
      kv(s2,'Color', d.color);
      kv(s2,'SQs', d.sqs);
      kv(s2,'Ice & Water', d.iceWater);
      kv(s2,'Drip Edge', d.dripEdge);
      kv(s2,'Gutter Apron', d.gutterApron);
      kv(s2,'Side Wall Flashing', d.sideWallFlashing);
      kv(s2,'Vents', d.vents);
      kv(s2,'Valleys', d.valleys);
      kv(s2,'Pipe Jacks', d.pipeJacks);
      kv(s2,'Ridge', d.ridge);
      kv(s2,'Roof Pitch', d.roofPitch);
      kv(s2,'Stories', d.stories);
      kv(s2,'Roof Size', d.roofSize);
      kv(s2,'Roof Type', d.roofType);

      // Gutters & Siding
      const s3 = sec('Gutters & Siding');
      kv(s3,'Gutters', d.gutters);
      kv(s3,'Downspouts', d.downspouts);
      kv(s3,'Gutter Color', d.gutterColor);
      kv(s3,'Downspout Color', d.downspoutColor);
      kv(s3,'Gutter Guards', d.gutterGuards);
      kv(s3,'Mag Roll Sweeper', d.magRoll);
      kv(s3,'Clean & Haul Debris', d.debris);
      kv(s3,'Siding Brand', d.sidingBrand);
      kv(s3,'Siding Style', d.sidingStyle);
      kv(s3,'Siding SQs', d.sidingSqs);
      kv(s3,'Siding Color', d.sidingColor);
      kv(s3,'Elevations', d.elevations);
      kv(s3,'Trim', d.trim);
      kv(s3,'Fascia', d.fascia);
      kv(s3,'Soffit', d.soffit);
      kv(s3,'Window Wraps', d.windowWraps);
      kv(s3,'Blocks', d.blocks);
      kv(s3,'Siding Notes', d.sidingNotes);
      kv(s3,'Partial or Full', d.partialFull);

      // Payments & Dates (two-column grid for compactness)
      const s4 = sec('Payments & Dates');
      const cols = document.createElement('div'); cols.className='grid2';
      const left = document.createElement('div'); const right = document.createElement('div');
      cols.appendChild(left); cols.appendChild(right); s4.appendChild(cols);
      // left
      kv(left,'Agreed Amount', currency(d.agreedAmount));
      kv(left,'First Payment', currency(d.firstPayment));
      kv(left,'Final Payment', currency(d.finalPayment));
      // right
      kv(right,'Customer Date', d.custDate);
      kv(right,'TDH Rep Date', d.repDate);
      kv(right,'TDH Representative', d.repName);

      page.appendChild(header);
      page.appendChild(s1);
      page.appendChild(s2);
      page.appendChild(s3);
      page.appendChild(s4);

      $('#printRoot').appendChild(page);
      return page;
    }

    async function downloadPDF(){
      const data = collectData();
      const page = buildPrintable(data);
      const filenameSafe = (data.name || 'TDH_Agreement').replace(/[^a-z0-9_\-]+/gi,'_');
      const opt = {
        margin:[0,0,0,0],
        filename: `${filenameSafe}_${new Date().toISOString().slice(0,10)}.pdf`,
        image: { type:'jpeg', quality:0.98 },
        html2canvas: { scale: 3, useCORS:true, letterRendering:true },
        jsPDF: { unit:'pt', format:'letter', orientation:'portrait' }
      };
      await html2pdf().set(opt).from(page).save();
    }

    $('#btnExample').addEventListener('click', loadExample);
    $('#btnClear').addEventListener('click', clearForm);
    $('#btnDownload').addEventListener('click', downloadPDF);
  </script>
</body>
</html>
